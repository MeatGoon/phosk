<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.teamproject.phosk.branch.menu.dao.ItemDAO">
	<sql id="itemAllInfo">
		select pc.branch_num, pc.category_num, pc.category_name,
		pi.item_num, pi.item_name, pi.item_image, pi.item_info,
		pi.item_lastDate, pi.item_regiDate,
		pb.basic_option1, pb.basic_option2,
		pb.basic_option3, pb.basic_option4, pb.basic_price1, pb.basic_price2,
		pb.basic_price3, pb.basic_price4,
		pa.add_option1, pa.add_option2,
		pa.add_option3, pa.add_option4, pa.add_option5, pa.add_price1,
		pa.add_price2, pa.add_price3, pa.add_price4, pa.add_price5
		from
		phosk_category pc, phosk_item pi, phosk_basicoption pb,
		phosk_addoption pa
		WHERE pc.category_num = pi.category_num and
		pi.item_num = pb.item_num and pi.item_num = pa.item_num
	</sql>
	<sql id="itemShorInfo">
		select pi.item_num, pi.item_name, pi.item_image,
		pi.item_info, pi.item_lastDate, pi.item_regiDate,
		pb.basic_option1,
		pb.basic_price1 from phosk_item pi, phosk_basicoption pb
		WHERE
		pi.item_num = pb.item_num
	</sql>
	<sql id="operItem">
		<choose>
		
		</choose>
	</sql>
	<select id="cateList" resultType="cateVO">
		select * from phosk_category
		<if test="branch_num != null">
			where branch_num = #{branch_num}
		</if>
	</select>
	<update id="updateTest">
		DECLARE
		BEGIN

		update phosk_category set category_name = #{category_name} where category_num = #{category_num};
		update phosk_item set item_name = #{item_name} where category_num = #{category_num}	AND item_num = #{item_num};
		update phosk_basicoption set basic_option1 = #{basic_option1} where item_num = #{item_num};
		<if test="add_option1 != null">
			update phosk_addoption set add_option1 = #{add_option1}, add_price1 = #{add_price1}
				<if test="add_option2 != null">
					, add_option2 = #{add_option2} , add_price2 = #{add_price2}
				</if>
				<if test="add_option3 != null">
					, add_option3 = #{add_option3} , add_price3 = #{add_price3}
				</if>
				<if test="add_option4 != null">
					, add_option4 = #{add_option4} , add_price4 = #{add_price4}
				</if>
				<if test="add_option5 != null">
					, add_option5 = #{add_option5} , add_price5 = #{add_price5}
				</if>
				<!-- 시간이 많이 남는다면 데이터 갈아엎어서 option부분을 하나의 값으로 List로 받아와서 foreach문으로 반복 wheb문 사용 -->
			where item_num = #{item_num};
		</if>
		END;
	</update>
	<select id="itemDetailInfo" resultType="branchItemInfo">
		<include refid="itemAllInfo" />
		and pc.branch_num = #{branch_num} and pc.category_num =
		#{category_num} and pi.item_num = #{item_num}
	</select>
	<select id="itemShorInfo" resultType="ItemVO">

	</select>
</mapper>